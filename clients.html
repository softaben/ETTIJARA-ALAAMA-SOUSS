<!DOCTYPE html>
<html lang="fr" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETTIJARA ALAAMA SOUSS - Gestion des Clients</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        :root {
            --primary: #1a237e;
            --secondary: #0d47a1;
            --accent: #1565c0;
            --success: #2e7d32;
            --warning: #ff9800;
            --danger: #d32f2f;
            --light: #e3f2fd;
            --bg: #f5f7fa;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: var(--bg); direction: rtl; color: #333; }

        /* Header */
        .header { 
            background: linear-gradient(135deg, var(--primary), var(--secondary)); 
            color: white; 
            height: 70px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            padding: 0 30px; 
            position: fixed; 
            width: 100%; 
            top: 0; 
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo i { font-size: 28px; }
        .logo h1 { font-size: 22px; font-weight: 700; }
        .logo span { color: #bbdefb; font-size: 14px; margin-top: 3px; }
        
        /* Navigation rapide */
        .quick-nav { display: flex; gap: 15px; }
        .quick-nav a { color: white; text-decoration: none; display: flex; align-items: center; gap: 5px; }
        
        /* Main Content */
        .main-content { 
            padding: 90px 30px 30px; 
            min-height: calc(100vh - 70px);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Page Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        .page-header h2 { color: var(--primary); font-size: 28px; display: flex; align-items: center; gap: 10px; }
        
        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 15px;
            border-right: 4px solid var(--primary);
        }
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }
        .stat-icon.total { background: #e3f2fd; color: var(--accent); }
        .stat-icon.active { background: #e8f5e9; color: var(--success); }
        .stat-icon.inactive { background: #fff3e0; color: var(--warning); }
        .stat-icon.new { background: #f3e5f5; color: #7b1fa2; }
        .stat-details { flex-grow: 1; }
        .stat-value { font-size: 24px; font-weight: 700; color: var(--primary); }
        .stat-label { font-size: 14px; color: #666; margin-top: 3px; }
        
        /* Controls */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .search-box {
            position: relative;
            flex-grow: 1;
            max-width: 400px;
        }
        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
        }
        .search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
        }
        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            min-width: 150px;
        }
        
        /* Buttons */
        button {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        .btn-primary:hover { background: var(--secondary); }
        .btn-success {
            background: var(--success);
            color: white;
        }
        .btn-success:hover { background: #1b5e20; }
        .btn-secondary {
            background: #f0f0f0;
            color: #555;
        }
        .btn-secondary:hover { background: #e0e0e0; }
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        .btn-danger:hover { background: #b71c1c; }
        
        /* Table Container */
        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-top: 20px;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
        }
        th {
            background: #f8f9fa;
            padding: 18px 15px;
            text-align: right;
            color: var(--primary);
            font-weight: 700;
            border-bottom: 2px solid #e9ecef;
            position: sticky;
            top: 0;
        }
        td {
            padding: 15px;
            border-bottom: 1px solid #f1f3f4;
            color: #555;
        }
        tr:hover { background: #f9f9f9; }
        
        /* Status Badge */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: inline-block;
        }
        .status-active { background: #e8f5e9; color: var(--success); }
        .status-inactive { background: #ffebee; color: var(--danger); }
        .status-pending { background: #fff3e0; color: var(--warning); }
        
        /* Client Type */
        .client-type {
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }
        .type-regular { background: #e3f2fd; color: var(--accent); }
        .type-vip { background: #f3e5f5; color: #7b1fa2; }
        .type-wholesale { background: #e8f5e9; color: var(--success); }
        
        /* Action Buttons */
        .action-buttons { display: flex; gap: 8px; }
        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .view-btn { background: #e3f2fd; color: var(--accent); border: 1px solid #bbdefb; }
        .edit-btn { background: #fff8e1; color: var(--warning); border: 1px solid #ffe082; }
        .delete-btn { background: #ffebee; color: var(--danger); border: 1px solid #ffcdd2; }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .modal-header h3 { color: var(--primary); margin: 0; }
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }
        
        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(21, 101, 192, 0.1);
        }
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding: 20px;
        }
        .pagination button {
            padding: 8px 15px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
        }
        .pagination button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Client Detail View */
        .client-detail {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .client-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .info-item label {
            font-weight: 600;
            color: #666;
            font-size: 14px;
            display: block;
            margin-bottom: 5px;
        }
        .info-item .value {
            font-size: 16px;
            color: #333;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .controls { flex-direction: column; align-items: stretch; }
            .search-box { max-width: 100%; }
            .filter-group { width: 100%; justify-content: space-between; }
            .main-content { padding: 90px 15px 20px; }
        }
        @media (max-width: 768px) {
            .header { padding: 0 15px; }
            .logo h1 { font-size: 18px; }
            .page-header { flex-direction: column; align-items: flex-start; }
            .stats-cards { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <i class="fas fa-users"></i>
            <div>
                <h1>ETTIJARA ALAAMA SOUSS - Clients</h1>
                <span>Gestion de la clientèle</span>
            </div>
        </div>
        <div class="quick-nav">
            <a href="dashboard.html">
                <i class="fas fa-home"></i> Tableau de Bord
            </a>
            <a href="deliveries.html">
                <i class="fas fa-truck"></i> Livraisons
            </a>
            <a href="products.html">
                <i class="fas fa-boxes"></i> Produits
            </a>
        </div>
    </header>

    <main class="main-content">
        <div class="page-header">
            <h2><i class="fas fa-users"></i> Gestion des Clients</h2>
            <button class="btn-primary" onclick="showAddClientModal()">
                <i class="fas fa-user-plus"></i> Nouveau Client
            </button>
        </div>

        <!-- Cartes de statistiques -->
        <div class="stats-cards">
            <div class="stat-card">
                <div class="stat-icon total">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-details">
                    <div class="stat-value" id="totalClients">0</div>
                    <div class="stat-label">Clients Totaux</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon active">
                    <i class="fas fa-user-check"></i>
                </div>
                <div class="stat-details">
                    <div class="stat-value" id="activeClients">0</div>
                    <div class="stat-label">Clients Actifs</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon inactive">
                    <i class="fas fa-user-clock"></i>
                </div>
                <div class="stat-details">
                    <div class="stat-value" id="inactiveClients">0</div>
                    <div class="stat-label">Clients Inactifs</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon new">
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="stat-details">
                    <div class="stat-value" id="newClients">0</div>
                    <div class="stat-label">Nouveaux ce Mois</div>
                </div>
            </div>
        </div>

        <!-- Contrôles de recherche et filtrage -->
        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Rechercher un client par nom, téléphone, ICE...">
                <i class="fas fa-search"></i>
            </div>
            
            <div class="filter-group">
                <select id="statusFilter">
                    <option value="">Tous les statuts</option>
                    <option value="active">Actif</option>
                    <option value="inactive">Inactif</option>
                </select>
                
                <select id="typeFilter">
                    <option value="">Tous les types</option>
                    <option value="regular">Client Régulier</option>
                    <option value="vip">Client VIP</option>
                    <option value="wholesale">Grossiste</option>
                </select>
                
                <select id="depotFilter">
                    <option value="">Tous les dépôts</option>
                    <option value="Jihadia">Dépôt Jihadia</option>
                    <option value="Ait Melloul">Dépôt Ait Melloul</option>
                    <option value="Inezgane">Dépôt Inezgane</option>
                    <option value="Dcheira">Dépôt Dcheira</option>
                </select>
                
                <button class="btn-secondary" onclick="applyFilters()">
                    <i class="fas fa-filter"></i> Filtrer
                </button>
                
                <button class="btn-secondary" onclick="resetFilters()">
                    <i class="fas fa-redo"></i> Réinitialiser
                </button>
            </div>
        </div>

        <!-- Tableau des clients -->
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th width="5%">#</th>
                        <th width="20%">Client</th>
                        <th width="15%">Contact</th>
                        <th width="15%">ICE/RC</th>
                        <th width="10%">Type</th>
                        <th width="10%">Dépôt</th>
                        <th width="10%">Statut</th>
                        <th width="15%">Actions</th>
                    </tr>
                </thead>
                <tbody id="clientsTable">
                    <!-- Les données seront chargées depuis Firebase -->
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px;">
                            <div style="color: #999;">
                                <i class="fas fa-users" style="font-size: 48px; margin-bottom: 15px;"></i>
                                <p>Chargement des clients...</p>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="pagination">
            <button id="prevPage" onclick="changePage(-1)" disabled>
                <i class="fas fa-chevron-right"></i> Précédent
            </button>
            <span id="pageInfo">Page 1 sur 1</span>
            <button id="nextPage" onclick="changePage(1)" disabled>
                Suivant <i class="fas fa-chevron-left"></i>
            </button>
        </div>

        <!-- Message vide -->
        <div id="noClientsMessage" style="display: none; text-align: center; padding: 40px; color: #777;">
            <i class="fas fa-user-slash" style="font-size: 60px; margin-bottom: 20px;"></i>
            <h3>Aucun client trouvé</h3>
            <p>Commencez par ajouter votre premier client</p>
            <button class="btn-primary" onclick="showAddClientModal()" style="margin-top: 15px;">
                <i class="fas fa-user-plus"></i> Ajouter un Client
            </button>
        </div>
    </main>

    <!-- Modal Ajout/Modification Client -->
    <div class="modal" id="clientModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Ajouter un Nouveau Client</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            
            <form id="clientForm" onsubmit="saveClient(event)">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="clientName">Nom Complet *</label>
                        <input type="text" id="clientName" required placeholder="Nom et prénom ou raison sociale">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientICE">ICE *</label>
                        <input type="text" id="clientICE" required placeholder="Identifiant Commun de l'Entreprise">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientRC">RC (Optionnel)</label>
                        <input type="text" id="clientRC" placeholder="Registre de Commerce">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientType">Type de Client *</label>
                        <select id="clientType" required>
                            <option value="regular">Client Régulier</option>
                            <option value="vip">Client VIP</option>
                            <option value="wholesale">Grossiste</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="clientPhone">Téléphone *</label>
                        <input type="tel" id="clientPhone" required placeholder="Ex: 06XXXXXXXX">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientEmail">Email (Optionnel)</label>
                        <input type="email" id="clientEmail" placeholder="email@exemple.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="clientDepot">Dépôt Assigné *</label>
                        <select id="clientDepot" required>
                            <option value="">-- Sélectionner un dépôt --</option>
                            <option value="Jihadia">Dépôt Jihadia - Agadir</option>
                            <option value="Ait Melloul">Dépôt Ait Melloul</option>
                            <option value="Inezgane">Dépôt Inezgane</option>
                            <option value="Dcheira">Dépôt Dcheira</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="clientStatus">Statut *</label>
                        <select id="clientStatus" required>
                            <option value="active">Actif</option>
                            <option value="inactive">Inactif</option>
                            <option value="pending">En attente</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientAddress">Adresse Complète *</label>
                    <textarea id="clientAddress" rows="3" required placeholder="Adresse complète avec ville"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="clientNotes">Notes (Optionnel)</label>
                    <textarea id="clientNotes" rows="2" placeholder="Informations supplémentaires..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="creditLimit">Limite de Crédit (DH)</label>
                    <input type="number" id="creditLimit" placeholder="0.00" step="0.01" min="0">
                </div>
                
                <input type="hidden" id="clientId">
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal()">
                        Annuler
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Enregistrer le Client
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Détails Client -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Détails du Client</h3>
                <button class="close-btn" onclick="closeDetailModal()">&times;</button>
            </div>
            
            <div id="clientDetailContent">
                <!-- Contenu chargé dynamiquement -->
            </div>
            
            <div class="form-actions">
                <button class="btn-secondary" onclick="closeDetailModal()">
                    Fermer
                </button>
                <button class="btn-primary" id="editClientBtn" onclick="editClientFromDetail()">
                    <i class="fas fa-edit"></i> Modifier
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "ettijara-alaama-souss.firebaseapp.com",
            databaseURL: "https://ettijara-alaama-souss-default-rtdb.firebaseio.com",
            projectId: "ettijara-alaama-souss",
            storageBucket: "ettijara-alaama-souss.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        
        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // Variables globales
        let clients = [];
        let filteredClients = [];
        let currentPage = 1;
        const itemsPerPage = 10;
        let editingClientId = null;
        let viewingClientId = null;
        
        // Données de démonstration (seront remplacées par Firebase)
        const sampleClients = [
            {
                id: "1",
                name: "Alimentation Nour Agadir",
                ice: "002547896541230",
                rc: "12345/2023",
                type: "vip",
                phone: "0528 123 456",
                email: "contact@nouragadir.ma",
                address: "Rue Mohammed V, Quartier Talborjt, Agadir",
                depot: "Jihadia",
                status: "active",
                creditLimit: 50000,
                notes: "Client fidèle depuis 2018",
                createdAt: "2023-05-15",
                ordersCount: 45,
                totalSpent: 245780
            },
            {
                id: "2",
                name: "Supermarché Atlas",
                ice: "002547896541231",
                rc: "12346/2023",
                type: "wholesale",
                phone: "0528 987 654",
                email: "achat@supermarcheatlas.ma",
                address: "Boulevard Hassan II, Agadir",
                depot: "Ait Melloul",
                status: "active",
                creditLimit: 100000,
                notes: "Livraison le lundi et jeudi",
                createdAt: "2023-06-20",
                ordersCount: 32,
                totalSpent: 189450
            },
            {
                id: "3",
                name: "Boulangerie Moderne",
                ice: "002547896541232",
                rc: "12347/2023",
                type: "regular",
                phone: "0528 456 789",
                email: "boulangeriemoderne@gmail.com",
                address: "Avenue des FAR, Inezgane",
                depot: "Inezgane",
                status: "active",
                creditLimit: 25000,
                notes: "Paiement à 30 jours",
                createdAt: "2023-07-10",
                ordersCount: 28,
                totalSpent: 89200
            },
            {
                id: "4",
                name: "Restaurant Al Bahja",
                ice: "002547896541233",
                rc: "12348/2023",
                type: "regular",
                phone: "0528 111 222",
                email: "info@albahja.ma",
                address: "Route de Marrakech, Dcheira",
                depot: "Dcheira",
                status: "active",
                creditLimit: 30000,
                notes: "Commande spéciale chaque vendredi",
                createdAt: "2023-08-05",
                ordersCount: 24,
                totalSpent: 75600
            },
            {
                id: "5",
                name: "Épicerie Fine Souss",
                ice: "002547896541234",
                rc: "12349/2023",
                type: "regular",
                phone: "0528 333 444",
                email: "",
                address: "Quartier Industriel, Ait Melloul",
                depot: "Ait Melloul",
                status: "active",
                creditLimit: 15000,
                notes: "",
                createdAt: "2023-09-12",
                ordersCount: 18,
                totalSpent: 45200
            },
            {
                id: "6",
                name: "Café Argan",
                ice: "002547896541235",
                rc: "12350/2023",
                type: "regular",
                phone: "0528 555 666",
                email: "cafeargan@contact.ma",
                address: "Centre Ville, Agadir",
                depot: "Jihadia",
                status: "inactive",
                creditLimit: 0,
                notes: "Client inactif depuis 3 mois",
                createdAt: "2023-03-22",
                ordersCount: 12,
                totalSpent: 28500
            },
            {
                id: "7",
                name: "Hôtel Palais Salam",
                ice: "002547896541236",
                rc: "12351/2023",
                type: "vip",
                phone: "0528 777 888",
                email: "achat@palais-salam.ma",
                address: "Boulevard Mohammed V, Agadir",
                depot: "Jihadia",
                status: "active",
                creditLimit: 150000,
                notes: "Client VIP - Contrat annuel",
                createdAt: "2023-01-15",
                ordersCount: 56,
                totalSpent: 425000
            },
            {
                id: "8",
                name: "Snack Express",
                ice: "002547896541237",
                rc: "12352/2023",
                type: "regular",
                phone: "06 12 34 56 78",
                email: "",
                address: "Route de l'Aéroport, Agadir",
                depot: "Jihadia",
                status: "pending",
                creditLimit: 5000,
                notes: "Nouveau client - En attente d'approbation",
                createdAt: "2024-01-10",
                ordersCount: 0,
                totalSpent: 0
            }
        ];
        
        // Charger les clients depuis Firebase
        function loadClientsFromFirebase() {
            // Dans un vrai projet, vous chargeriez depuis Firebase:
            // database.ref('clients').once('value', snapshot => { ... })
            
            // Pour l'exemple, nous utilisons les données de démonstration
            clients = [...sampleClients];
            filteredClients = [...clients];
            
            updateStats();
            renderClientsTable();
            updatePagination();
        }
        
        // Mettre à jour les statistiques
        function updateStats() {
            const total = clients.length;
            const active = clients.filter(c => c.status === 'active').length;
            const inactive = clients.filter(c => c.status === 'inactive').length;
            
            // Calculer les nouveaux clients ce mois (exemple)
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const newClients = clients.filter(c => {
                const clientDate = new Date(c.createdAt);
                return clientDate.getMonth() === currentMonth && 
                       clientDate.getFullYear() === currentYear;
            }).length;
            
            document.getElementById('totalClients').textContent = total;
            document.getElementById('activeClients').textContent = active;
            document.getElementById('inactiveClients').textContent = inactive;
            document.getElementById('newClients').textContent = newClients;
        }
        
        // Rendre le tableau des clients
        function renderClientsTable() {
            const tbody = document.getElementById('clientsTable');
            const noClientsMessage = document.getElementById('noClientsMessage');
            
            if (filteredClients.length === 0) {
                tbody.innerHTML = '';
                noClientsMessage.style.display = 'block';
                return;
            }
            
            noClientsMessage.style.display = 'none';
            
            // Calculer l'index de début et de fin pour la pagination
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageClients = filteredClients.slice(startIndex, endIndex);
            
            let html = '';
            
            pageClients.forEach((client, index) => {
                const globalIndex = startIndex + index + 1;
                
                // Déterminer les classes CSS
                let statusClass = 'status-active';
                let statusText = 'Actif';
                
                if (client.status === 'inactive') {
                    statusClass = 'status-inactive';
                    statusText = 'Inactif';
                } else if (client.status === 'pending') {
                    statusClass = 'status-pending';
                    statusText = 'En attente';
                }
                
                let typeClass = 'type-regular';
                let typeText = 'Régulier';
                
                if (client.type === 'vip') {
                    typeClass = 'type-vip';
                    typeText = 'VIP';
                } else if (client.type === 'wholesale') {
                    typeClass = 'type-wholesale';
                    typeText = 'Grossiste';
                }
                
                html += `
                    <tr>
                        <td>${globalIndex}</td>
                        <td>
                            <strong>${client.name}</strong>
                            ${client.email ? `<br><small>${client.email}</small>` : ''}
                        </td>
                        <td>${client.phone}</td>
                        <td>
                            <strong>ICE:</strong> ${client.ice}<br>
                            ${client.rc ? `<small>RC: ${client.rc}</small>` : ''}
                        </td>
                        <td><span class="client-type ${typeClass}">${typeText}</span></td>
                        <td>${client.depot}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn view-btn" onclick="viewClientDetail('${client.id}')">
                                    <i class="fas fa-eye"></i> Voir
                                </button>
                                <button class="action-btn edit-btn" onclick="editClient('${client.id}')">
                                    <i class="fas fa-edit"></i> Modifier
                                </button>
                                <button class="action-btn delete-btn" onclick="deleteClient('${client.id}', '${client.name}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // Appliquer les filtres
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const depotFilter = document.getElementById('depotFilter').value;
            
            filteredClients = clients.filter(client => {
                // Filtre de recherche
                const matchesSearch = !searchTerm || 
                    client.name.toLowerCase().includes(searchTerm) ||
                    client.phone.includes(searchTerm) ||
                    client.ice.includes(searchTerm) ||
                    (client.email && client.email.toLowerCase().includes(searchTerm));
                
                // Filtre de statut
                const matchesStatus = !statusFilter || client.status === statusFilter;
                
                // Filtre de type
                const matchesType = !typeFilter || client.type === typeFilter;
                
                // Filtre de dépôt
                const matchesDepot = !depotFilter || client.depot === depotFilter;
                
                return matchesSearch && matchesStatus && matchesType && matchesDepot;
            });
            
            currentPage = 1;
            renderClientsTable();
            updatePagination();
        }
        
        // Réinitialiser les filtres
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('typeFilter').value = '';
            document.getElementById('depotFilter').value = '';
            
            filteredClients = [...clients];
            currentPage = 1;
            renderClientsTable();
            updatePagination();
        }
        
        // Mettre à jour la pagination
        function updatePagination() {
            const totalPages = Math.ceil(filteredClients.length / itemsPerPage);
            const pageInfo = document.getElementById('pageInfo');
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');
            
            pageInfo.textContent = `Page ${currentPage} sur ${totalPages}`;
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages || totalPages === 0;
        }
        
        // Changer de page
        function changePage(direction) {
            const totalPages = Math.ceil(filteredClients.length / itemsPerPage);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderClientsTable();
                updatePagination();
            }
        }
        
        // Afficher le modal d'ajout de client
        function showAddClientModal() {
            editingClientId = null;
            document.getElementById('modalTitle').textContent = 'Ajouter un Nouveau Client';
            document.getElementById('clientForm').reset();
            document.getElementById('clientId').value = '';
            
            // Définir la date de création à aujourd'hui
            const today = new Date().toISOString().split('T')[0];
            
            // Ouvrir le modal
            document.getElementById('clientModal').style.display = 'flex';
        }
        
        // Fermer le modal
        function closeModal() {
            document.getElementById('clientModal').style.display = 'none';
            editingClientId = null;
        }
        
        // Éditer un client
        function editClient(clientId) {
            const client = clients.find(c => c.id === clientId);
            if (!client) return;
            
            editingClientId = clientId;
            document.getElementById('modalTitle').textContent = 'Modifier le Client';
            
            // Remplir le formulaire avec les données du client
            document.getElementById('clientId').value = client.id;
            document.getElementById('clientName').value = client.name;
            document.getElementById('clientICE').value = client.ice;
            document.getElementById('clientRC').value = client.rc || '';
            document.getElementById('clientType').value = client.type;
            document.getElementById('clientPhone').value = client.phone;
            document.getElementById('clientEmail').value = client.email || '';
            document.getElementById('clientDepot').value = client.depot;
            document.getElementById('clientStatus').value = client.status;
            document.getElementById('clientAddress').value = client.address;
            document.getElementById('clientNotes').value = client.notes || '';
            document.getElementById('creditLimit').value = client.creditLimit || '';
            
            // Ouvrir le modal
            document.getElementById('clientModal').style.display = 'flex';
        }
        
        // Sauvegarder un client
        function saveClient(event) {
            event.preventDefault();
            
            // Récupérer les données du formulaire
            const clientData = {
                name: document.getElementById('clientName').value,
                ice: document.getElementById('clientICE').value,
                rc: document.getElementById('clientRC').value,
                type: document.getElementById('clientType').value,
                phone: document.getElementById('clientPhone').value,
                email: document.getElementById('clientEmail').value,
                depot: document.getElementById('clientDepot').value,
                status: document.getElementById('clientStatus').value,
                address: document.getElementById('clientAddress').value,
                notes: document.getElementById('clientNotes').value,
                creditLimit: parseFloat(document.getElementById('creditLimit').value) || 0,
                updatedAt: new Date().toISOString()
            };
            
            if (editingClientId) {
                // Mise à jour d'un client existant
                clientData.id = editingClientId;
                
                // Dans un vrai projet, vous mettriez à jour dans Firebase
                // database.ref('clients/' + editingClientId).update(clientData);
                
                // Mise à jour dans le tableau local
                const index = clients.findIndex(c => c.id === editingClientId);
                if (index !== -1) {
                    clients[index] = { ...clients[index], ...clientData };
                }
                
                alert('Client mis à jour avec succès!');
            } else {
                // Création d'un nouveau client
                clientData.id = 'client_' + Date.now();
                clientData.createdAt = new Date().toISOString();
                clientData.ordersCount = 0;
                clientData.totalSpent = 0;
                
                // Dans un vrai projet, vous ajouteriez dans Firebase
                // database.ref('clients/' + clientData.id).set(clientData);
                
                // Ajout dans le tableau local
                clients.unshift(clientData);
                
                alert('Client ajouté avec succès!');
            }
            
            // Fermer le modal et mettre à jour l'interface
            closeModal();
            filteredClients = [...clients];
            updateStats();
            renderClientsTable();
            updatePagination();
        }
        
        // Supprimer un client
        function deleteClient(clientId, clientName) {
            if (!confirm(`Êtes-vous sûr de vouloir supprimer le client "${clientName}" ?`)) {
                return;
            }
            
            // Dans un vrai projet, vous supprimeriez de Firebase
            // database.ref('clients/' + clientId).remove();
            
            // Suppression du tableau local
            clients = clients.filter(c => c.id !== clientId);
            filteredClients = filteredClients.filter(c => c.id !== clientId);
            
            // Si nous venons de supprimer le dernier client de la page, revenir à la page précédente
            const totalPages = Math.ceil(filteredClients.length / itemsPerPage);
            if (currentPage > totalPages && totalPages > 0) {
                currentPage = totalPages;
            }
            
            updateStats();
            renderClientsTable();
            updatePagination();
            
            alert('Client supprimé avec succès!');
        }
        
        // Afficher les détails d'un client
        function viewClientDetail(clientId) {
            const client = clients.find(c => c.id === clientId);
            if (!client) return;
            
            viewingClientId = clientId;
            
            // Déterminer les textes et classes
            let statusClass = 'status-active';
            let statusText = 'Actif';
            
            if (client.status === 'inactive') {
                statusClass = 'status-inactive';
                statusText = 'Inactif';
            } else if (client.status === 'pending') {
                statusClass = 'status-pending';
                statusText = 'En attente';
            }
            
            let typeClass = 'type-regular';
            let typeText = 'Client Régulier';
            
            if (client.type === 'vip') {
                typeClass = 'type-vip';
                typeText = 'Client VIP';
            } else if (client.type === 'wholesale') {
                typeClass = 'type-wholesale';
                typeText = 'Grossiste';
            }
            
            // Formater la date
            const createdAt = new Date(client.createdAt);
            const formattedDate = createdAt.toLocaleDateString('fr-FR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Générer le contenu
            const content = `
                <div class="client-detail">
                    <div class="detail-header">
                        <div>
                            <h3 style="margin: 0; color: var(--primary);">${client.name}</h3>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <span class="status-badge ${statusClass}">${statusText}</span>
                                <span class="client-type ${typeClass}">${typeText}</span>
                            </div>
                        </div>
                        <div style="text-align: left;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                ${client.totalSpent.toLocaleString()} DH
                            </div>
                            <div style="font-size: 14px; color: #666;">Total dépensé</div>
                        </div>
                    </div>
                    
                    <div class="client-info-grid">
                        <div class="info-item">
                            <label>ICE</label>
                            <div class="value">${client.ice}</div>
                        </div>
                        <div class="info-item">
                            <label>RC</label>
                            <div class="value">${client.rc || 'Non renseigné'}</div>
                        </div>
                        <div class="info-item">
                            <label>Téléphone</label>
                            <div class="value">${client.phone}</div>
                        </div>
                        <div class="info-item">
                            <label>Email</label>
                            <div class="value">${client.email || 'Non renseigné'}</div>
                        </div>
                        <div class="info-item">
                            <label>Dépôt Assigné</label>
                            <div class="value">${client.depot}</div>
                        </div>
                        <div class="info-item">
                            <label>Limite de Crédit</label>
                            <div class="value">${client.creditLimit.toLocaleString()} DH</div>
                        </div>
                        <div class="info-item">
                            <label>Commandes</label>
                            <div class="value">${client.ordersCount} commandes</div>
                        </div>
                        <div class="info-item">
                            <label>Date d'ajout</label>
                            <div class="value">${formattedDate}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <label style="font-weight: 600; color: #666; display: block; margin-bottom: 8px;">Adresse</label>
                        <div style="padding: 12px; background: white; border-radius: 8px; border: 1px solid #eee;">
                            ${client.address}
                        </div>
                    </div>
                    
                    ${client.notes ? `
                    <div style="margin-top: 20px;">
                        <label style="font-weight: 600; color: #666; display: block; margin-bottom: 8px;">Notes</label>
                        <div style="padding: 12px; background: white; border-radius: 8px; border: 1px solid #eee;">
                            ${client.notes}
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('clientDetailContent').innerHTML = content;
            document.getElementById('detailModal').style.display = 'flex';
            
            // Mettre à jour le bouton d'édition
            document.getElementById('editClientBtn').onclick = () => {
                closeDetailModal();
                editClient(clientId);
            };
        }
        
        // Fermer le modal de détails
        function closeDetailModal() {
            document.getElementById('detailModal').style.display = 'none';
            viewingClientId = null;
        }
        
        // Éditer un client depuis la vue détail
        function editClientFromDetail() {
            if (viewingClientId) {
                closeDetailModal();
                editClient(viewingClientId);
            }
        }
        
        // Recherche en temps réel
        document.getElementById('searchInput').addEventListener('input', function() {
            // Délai pour éviter trop de re-renders
            clearTimeout(window.searchTimeout);
            window.searchTimeout = setTimeout(() => {
                applyFilters();
            }, 300);
        });
        
        // Initialiser au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            loadClientsFromFirebase();
            
            // Écouter les changements dans les filtres
            ['statusFilter', 'typeFilter', 'depotFilter'].forEach(id => {
                document.getElementById(id).addEventListener('change', applyFilters);
            });
        });
    </script>
</body>
</html>
